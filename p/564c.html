<!DOCTYPE html><html lang=zh-CN><head hexo-theme=https://github.com/volantis-x/hexo-theme-volantis/tree/4.3.1><meta charset=utf-8><meta http-equiv=x-dns-prefetch-control content=on><link rel=dns-prefetch href=https://cdn.jsdelivr.net><link rel=preconnect href=https://cdn.jsdelivr.net crossorigin><meta name=renderer content=webkit><meta name=force-rendering content=webkit><meta http-equiv=X-UA-Compatible content="IE=Edge,chrome=1"><meta name=HandheldFriendly content=True><meta name=apple-mobile-web-app-capable content=yes><meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=1"><link rel=preload href=/css/first.css as=style><title>2021：树莓派入坑指南 - Hajeekn RSSHUB</title><link rel=alternate href=/atom.xml title="Hajeekn RSSHUB" type=application/atom+xml><meta name=referrer content=no-referrer><link rel=stylesheet href=/css/diy.css><link rel=stylesheet href=/css/first.css><link rel=stylesheet href=/css/style.css media=print onload="this.media='all';this.onload=null"><noscript><link rel=stylesheet href=/css/style.css></noscript><script id=loadcss></script><script>
if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode))
    document.write(
	'<style>'+
		'html{'+
			'overflow-x: hidden !important;'+
			'overflow-y: hidden !important;'+
		'}'+
		'.kill-ie{'+
			'text-align:center;'+
			'height: 100%;'+
			'margin-top: 15%;'+
			'margin-bottom: 5500%;'+
		'}'+
	'</style>'+
    '<div class="kill-ie">'+
        '<h1><b>抱歉，您的浏览器无法访问本站</b></h1>'+
        '<h3>微软已经于2016年终止了对 Internet Explorer (IE) 10 及更早版本的支持，<br/>'+
        '继续使用存在极大的安全隐患，请使用当代主流的浏览器进行访问。</h3><br/>'+
        '<a target="_blank" rel="noopener" href="https://www.microsoft.com/zh-cn/WindowsForBusiness/End-of-IE-support"><strong>了解详情 ></strong></a>'+
    '</div>');
</script><noscript><style>
		html{
			overflow-x: hidden !important;
			overflow-y: hidden !important;
		}
		.kill-noscript{
			text-align:center;
			height: 100%;
			margin-top: 15%;
			margin-bottom: 5500%;
		}
	</style><div class=kill-noscript><h1><b>抱歉，您的浏览器无法访问本站</b></h1><h3>本页面需要浏览器支持（启用）JavaScript</h3><br><a target=_blank rel=noopener href="https://www.baidu.com/s?wd=启用JavaScript"><strong>了解详情 ></strong></a></div></noscript></head><body><header id=l_header class="l_header always shadow blur show"><div class=container><div id=wrapper><div class=nav-sub><p class=title></p><ul class="switcher nav-list-h m-phone" id=pjax-header-nav-list><li><a id=s-comment class="fas fa-comments fa-fw" target=_self href=javascript:void(0)></a></li><li><a id=s-toc class="s-toc fas fa-list fa-fw" target=_self href=javascript:void(0)></a></li></ul></div><div class=nav-main><a class="title flat-box" target=_self href="/"><img no-lazy class=logo src=https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/Logo-NavBar@3x.png></a><div class="menu navigation"><ul class="nav-list-h m-pc"><li><a class="menuitem flat-box faa-parent animated-hover" href="/" id=home><i class="fas fa-home fa-fw fa-fw"></i> 主页</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E5%8D%9A%E5%AE%A2/" id=categoriesE58D9AE5AEA2><i class="fas fa-rss fa-fw"></i> 博客订阅</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E6%96%B0%E5%AA%92%E4%BD%93/" id=categoriesE696B0E5AA92E4BD93><i class="fas fa-podcast fa-fw fa-fw"></i> 新媒体</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E4%BA%8C%E6%AC%A1%E5%85%83/" id=categoriesE4BA8CE6ACA1E58583><i class="fas fa-heart fa-fw fa-fw"></i> 二次元</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E6%B8%B8%E6%88%8F/" id=categoriesE6B8B8E6888F><i class="fa fa-gamepad fa-fw fa-fw"></i> 游戏</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E5%9B%BE%E7%89%87/" id=categoriesE59BBEE78987><i class="fas fa-puzzle-piece fa-fw fa-fw"></i> 图片</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E8%AE%BE%E8%AE%A1/" id=categoriesE8AEBEE8AEA1><i class="fas fa-magic fa-fw fa-fw"></i> 设计</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E7%BC%96%E7%A8%8B/" id=categoriesE7BC96E7A88B><i class="fas fa-code fa-fw fa-fw"></i> 编程</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E9%87%91%E8%9E%8D/" id=categoriesE98791E89E8D><i class="fas fa-key fa-fw fa-fw"></i> 金融</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/" id=categoriesE7A4BEE4BAA4E5AA92E4BD93><i class="fas fa-users fa-fw fa-fw"></i> 社交媒体</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E9%98%85%E8%AF%BB/" id=categoriesE99885E8AFBB><i class="fas fa-book fa-fw fa-fw"></i> 阅读</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E5%AD%A6%E4%B9%A0/" id=categoriesE5ADA6E4B9A0><i class="fas fa-graduation-cap fa-fw fa-fw"></i> 学习</a></li></ul></div><div class=m_search><form name=searchform class="form u-search-form"><i class="icon fas fa-search fa-fw"></i> <input type=text class="input u-search-input" placeholder=Search...></form></div><ul class="switcher nav-list-h m-phone"><li><a class="s-search fas fa-search fa-fw" target=_self href=javascript:void(0)></a></li><li><a class="s-menu fas fa-bars fa-fw" target=_self href=javascript:void(0)></a><ul class="menu-phone list-v navigation white-box"><li><a class="menuitem flat-box faa-parent animated-hover" href="/" id=home><i class="fas fa-home fa-fw fa-fw"></i> 主页</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E5%8D%9A%E5%AE%A2/" id=categoriesE58D9AE5AEA2><i class="fas fa-rss fa-fw"></i> 博客订阅</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E6%96%B0%E5%AA%92%E4%BD%93/" id=categoriesE696B0E5AA92E4BD93><i class="fas fa-podcast fa-fw fa-fw"></i> 新媒体</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E4%BA%8C%E6%AC%A1%E5%85%83/" id=categoriesE4BA8CE6ACA1E58583><i class="fas fa-heart fa-fw fa-fw"></i> 二次元</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E6%B8%B8%E6%88%8F/" id=categoriesE6B8B8E6888F><i class="fa fa-gamepad fa-fw fa-fw"></i> 游戏</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E5%9B%BE%E7%89%87/" id=categoriesE59BBEE78987><i class="fas fa-puzzle-piece fa-fw fa-fw"></i> 图片</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E8%AE%BE%E8%AE%A1/" id=categoriesE8AEBEE8AEA1><i class="fas fa-magic fa-fw fa-fw"></i> 设计</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E7%BC%96%E7%A8%8B/" id=categoriesE7BC96E7A88B><i class="fas fa-code fa-fw fa-fw"></i> 编程</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E9%87%91%E8%9E%8D/" id=categoriesE98791E89E8D><i class="fas fa-key fa-fw fa-fw"></i> 金融</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/" id=categoriesE7A4BEE4BAA4E5AA92E4BD93><i class="fas fa-users fa-fw fa-fw"></i> 社交媒体</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E9%98%85%E8%AF%BB/" id=categoriesE99885E8AFBB><i class="fas fa-book fa-fw fa-fw"></i> 阅读</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/%E5%AD%A6%E4%B9%A0/" id=categoriesE5ADA6E4B9A0><i class="fas fa-graduation-cap fa-fw fa-fw"></i> 学习</a></li></ul></li></ul></div></div></div></header><div id=l_body><div id=l_cover><div id=full class="cover-wrapper post dock" style="display: none;"><div class="cover-bg lazyload placeholder" data-bg="https://uploadbeta.com/api/pictures/random/?key=BingEverydayWallpaperPicture"></div><div class=cover-body><div class=top><p class=title>Volantis</p></div><div class=bottom><div class="menu navigation"><div class=list-h><a href="/v4/getting-started/" id=v4getting-started><img src=https://cdn.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f5c3.svg><p>文档</p></a> <a href="/faqs/" id=faqs><img src=https://cdn.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f516.svg><p>帮助</p></a> <a href="/examples/" id=examples><img src=https://cdn.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f396.svg><p>示例</p></a> <a href="/contributors/" id=contributors><img src=https://cdn.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f389.svg><p>社区</p></a> <a href="/archives/" id=archives><img src=https://cdn.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f4f0.svg><p>博客</p></a> <a target=_blank rel=noopener href="https://github.com/volantis-x/hexo-theme-volantis/" id=https:githubcomvolantis-xhexo-theme-volantis><img src=https://cdn.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f9ec.svg><p>源码</p></a></div></div></div></div><div id=scroll-down style="display: none;"><i class="fa fa-chevron-down scroll-down-effects"></i></div></div></div><div id=safearea><div class=body-wrapper id=pjax-container><div class=l_main><article class="article post white-box reveal md shadow article-type-post" id=post itemscope itemprop=blogPost><div class=headimg-div><a class=headimg-a><img class=headimg src=https://cdn.sspai.com/2021/06/15/3060e23855b927fd73c99f533d37da74.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1></a></div><div class=article-meta id=top><a title=2021：树莓派入坑指南 href=/p/564c.html><img class=thumbnail src=https://cdn.sspai.com/2021/06/15/3060e23855b927fd73c99f533d37da74.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1></a><h1 class=title>2021：树莓派入坑指南</h1><div class=new-meta-box><div class="new-meta-item author"><a class=author target=_blank href="https://docs.rsshub.app/" rel="nofollow noopener"><img no-lazy src=https://i.loli.net/2019/04/23/5cbeb7e41414c.png><p>RSSHub</p></a></div><div class="new-meta-item category"><a class=notlink><i class="fas fa-folder-open fa-fw" aria-hidden=true></i> <a class=category-link href="/categories/%E6%96%B0%E5%AA%92%E4%BD%93/">新媒体</a><span class=sep></span><a class=category-link href="/categories/%E6%96%B0%E5%AA%92%E4%BD%93/%E5%B0%91%E6%95%B0%E6%B4%BE-sspai/">少数派 sspai</a><span class=sep></span><a class=category-link href="/categories/%E6%96%B0%E5%AA%92%E4%BD%93/%E5%B0%91%E6%95%B0%E6%B4%BE-sspai/Matrix/">Matrix</a></a></div><div class="new-meta-item date"><a class=notlink><i class="fas fa-calendar-alt fa-fw" aria-hidden=true></i><p>发布于：2021年7月5日</p></a></div><div class="new-meta-item browse leancloud"><a class=notlink><div id=lc-pv data-title=2021：树莓派入坑指南 data-path=/p/564c.html><i class="fas fa-eye fa-fw" aria-hidden=true></i><span id=number><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden=true></i></span> 次浏览</div></a></div></div></div><div><div class=articleWidth-content data-v-e1f0100a><div class="content wangEditor-txt minHeight" data-v-e1f0100a><h3 style=margin-left:0px;><strong>专栏文章 首页推荐</strong></h3><p style=margin-left:0px;>少数派专栏是 Matrix 社区中的一部分，我们会不定期挑选专栏中最优质的文章，展示来自用户和开发者的真实体验和观点。<a target=_blank rel=noopener href=https://sspai.com/post/65959>点此</a> 了解什么是少数派专栏，<a target=_blank rel=noopener href=https://sspai.com/columns>点击</a> 查看全部少数派专栏。</p><p>本文来自 <a href=https://sspai.com/column/162 target=_blank>树莓派</a> 专栏，树莓派是一系列的微型电脑，搭载了开源的操作系统，配备多种拓展接口，具有极高可玩性。关注专栏，随时掌握最新资讯，了解更多实用教程，培养动手能力与折腾精神。</p><p>文章代表作者个人观点，少数派仅对标题和排版略作修改。</p><hr><h2>前言</h2><p>树莓派是只有信用卡大小、可运行操作系统的计算机 <sup class=ss-footnote href=https://sspai.com/post/64602 title="除了 2021 年 1 月份发布的新品 Raspberry Pi Pico，它是一款单片机开发板。" footnote-id=1>1</sup>。第一款树莓派于 2012 年发售，至今已有 9 年。9 年间，大大小小、稀奇古怪的树莓派项目遍地开花：卫星制造公司 <a href="https://www.raspberrypi.org/blog/raspberry-pi-in-space/" target=_blank>将树莓派安装到人造卫星里</a> ，为卫星提供拍摄和图片传输功能；科技爱好者们使用树莓派搭建 <a href=https://opensource.com/article/17/3/building-personal-web-server-raspberry-pi-3 target=_blank>Web 服务器</a> 、<a href=https://shumeipai.nxez.com/2018/11/01/a-raspberry-pi-nas-that-really-look-like-a-nas.html target=_blank>NAS</a>、 <a href=https://shumeipai.nxez.com/2020/08/17/smartpet-smart-pet-feeder.html target=_blank>智能家居</a> ；游戏玩家在树莓派的帮助下， <a href=https://www.yystv.cn/n/946781 target=_blank>让 1989 年的 GameBoy 实现了在线联机</a> ；科技博主使用树莓派采集并识别街景，制作了 <a href=https://www.yystv.cn/p/7792 target=_blank>一台向路过的狗狗发出赞美的机器</a> 。树莓派以其只有信用卡大小的尺寸、五脏俱全的软硬件功能以及两者结合带来的丰富可玩性而深受大家的喜爱，不断吸引着新的小伙伴入坑。本文便是一份面向准备入坑或者刚入坑树莓派的新人玩家的上手指南。</p><p>都 2021 年了，还有必要写树莓派上手指南吗？ 一番调研之后，我认为答案是肯定的。虽然网络上已经有很多新手向的树莓派上手教程，我派作者 <a href=https://sspai.com/u/a99heyy3/updates target=_blank>@ 梓姵君</a> 和 <a href=https://sspai.com/u/2l82dcjv/updates target=_blank>@Sunbelife</a> 也分别在 2014 和 2017 年就发表了相关文章，但是，一方面，树莓派的软硬件更新活跃，一些上手教程的内容已经过时，需要更新和补充；另一方面，一些教程内容比较分散，对新手不够友好。因此，我希望在前辈们的基础上，整理一篇 2021 年最新的、浅显易懂的、比较全面的树莓派入坑指南，避免晦涩的术语和冗长的代码，力求让最没有基础的新人玩家只看这一篇文章，也可以顺利完成对树莓派的选购、配置和使用。</p><p>我们开始吧。</p><p>❗注：本文需要用到搭载 Windows 或 macOS 的电脑（下文称为 PC）。文中操作演示在搭载 Windows 的电脑上进行，但我会给出在搭载 macOS 的电脑上操作的方法。</p><h2>购买树莓派和配件</h2><p>截至 2021 年 6 月，树莓派基金会官网一共有 11 款树莓派产品 <a href="https://www.raspberrypi.org/products/" target=_blank>在售</a>。这 11 款产品中，有 1 款是今年 1 月份发布的 Raspberry Pi Pico，它是一款单片机开发板；其他 10 款产品都是可以运行操作系统的电脑。根据外观、配置和性能，这 10 款产品可以分为 3 个系列：</p><ol><li>Model B 系列：当家旗舰</li><li>Model A 系列：外形较小，配置和接口略有阉割</li><li>Zero 系列：拥有超小身材</li></ol><p>我制作了一张简化的产品介绍图，图片展示了各个系列各代产品的型号和外观参考照片，产品型号的颜色越深表示发布时间越晚、配置和性能越高；图中除了 Raspberry Pi 400 外，其它产品照片缩放比例相同，因此大家可以直观对比它们的外形大小差异。Raspberry Pi 400 是套了键盘「马甲」的 Raspberry Pi 4 Model B，两者配置相同。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/15/3060e23855b927fd73c99f533d37da74.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/15/3060e23855b927fd73c99f533d37da74.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/15/3060e23855b927fd73c99f533d37da74.jpg referrerpolicy=no-referrer><figcaption>▲在售的 11 款树莓派产品，图中产品外观照片来自 <a href="https://www.raspberrypi.org/help/" target=_blank>Raspberry Pi Foundation</a>。</figcaption></figure><ul><li>📖 拓展阅读： <a href="https://shumeipai.nxez.com/" target=_blank>树莓派实验室</a> 整理并绘制了详细 <a href=https://shumeipai.nxez.com/raspberry-pi-version-compare target=_blank>参数对比</a> 表格，大家可以移步查看。</li></ul><p>根据电子产品「买新不买旧」的思路，我建议正在持币观望、准备入坑的新手玩家一步到位购买 Raspberry Pi 4 Model B（也称「树莓派 4B」），因为它是最新的旗舰产品，功能和接口最为齐全，这既可以降低上手难度，又可以在我们还不确定要用树莓派来做什么的时候提供多种可玩性。</p><p>除了树莓派本体，我们还需要购买一些配件：</p><figure class=table><table><thead><tr><th style=text-align:center;>配件</th><th style=text-align:center;>用途</th></tr></thead><tbody><tr><td>容量 8 GB 以上的 TF 卡</td><td>用于加载树莓派的系统</td></tr><tr><td>TF 卡读卡器</td><td>用于将 TF 卡接入电脑，烧录树莓派系统</td></tr><tr><td>5 V / 3 A 以上的电源</td><td>为树莓派供电</td></tr></tbody></table></figure><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/21/857274e0d30aca23ea44f68d68bd0b16.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/21/857274e0d30aca23ea44f68d68bd0b16.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/21/857274e0d30aca23ea44f68d68bd0b16.jpg referrerpolicy=no-referrer><figcaption>▲ 买齐这些就够了。</figcaption></figure><p>对于树莓派的购买渠道，在树莓派基金会官网可以找到授权分销商的淘宝店铺，另外树莓派实验室也有官方淘宝店铺，这些都是比较靠谱的购买渠道。至于充电器，如果大家手头的充电器满足要求，就不需要购买了。需要留意的是所购买的树莓派型号的电源接口类型，树莓派 4B 使用的是 USB-C 接口，而更早的产品用的是 MicroUSB 接口。</p><h2>烧录树莓派系统</h2><p>树莓派是一个电脑，因此需要为它准备操作系统。我们买到树莓派之后，接下来要做的事情就是选择并下载合适的操作系统，并烧录到 TF 卡中。</p><p>目前，树莓派基金会官方和第三方开发者为树莓派开发了多个操作系统。官方开发的系统称为 Raspberry Pi OS，曾用名 Raspbian，目前更新至 5.10 版本，兼容所有的树莓派产品（除了 Pico）。作为新手，我们就先使用官方推荐的 Raspberry Pi OS 桌面版来入门，等上手之后再捣鼓 <a href="https://make.quwj.com/member/2/bookmarks?category=37" target=_blank>其它好玩的系统</a> 不迟。如果 TF 卡存储空间充裕（≥ 16 GB），也可以使用「桌面 + 常用软件」的版本。</p><figure class=table><table><thead><tr><th>官方提供的操作系统</th><th>说明</th></tr></thead><tbody><tr><td><a href=https://downloads.raspberrypi.org/raspios_lite_armhf_latest target=_blank>Raspberry Pi OS Lite 版</a></td><td>没有图形化桌面，只有命令行界面。</td></tr><tr><td><a href=https://downloads.raspberrypi.org/raspios_armhf_latest target=_blank>Raspberry Pi OS 桌面版</a></td><td>具有图形化桌面。</td></tr><tr><td><a href=https://downloads.raspberrypi.org/raspios_full_armhf_latest target=_blank>Raspberry Pi OS 桌面版 + 常用软件</a></td><td>具有图形化桌面，预装了常用编程、办公、娱乐软件。</td></tr></tbody></table></figure><p>我们在 PC 的浏览器中点击表格中的链接，下载操作系统的 img 文件。</p><p>现在，我们将 TF 卡通过读卡器接入到 PC 中。</p><p>接着，我们下载并安装一个用于向 TF 卡烧录 img 文件的软件 <a href=https://make.quwj.com/bookmark/327/go target=_blank>Win32DiskImager</a>。</p><p>打开 Win32DiskImager，在「映像文件」中选中下载到的 img 文件，确认「设备」选中的是 TF 卡对应的盘符，然后点击「写入」，此时软件弹出「确认覆盖」的警告，点击「Yes」开始就可以开始烧录。</p><figure class="image ss-img-wrapper image_resized" style=width:345px;><img src=https://cdn.sspai.com/2021/06/15/cd07d940dfa9cd1b331ac5931d8e1fe4.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/15/cd07d940dfa9cd1b331ac5931d8e1fe4.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/15/cd07d940dfa9cd1b331ac5931d8e1fe4.png referrerpolicy=no-referrer></figure><p>烧录完成后，TF 卡会产生另一个 Windows 无法识别的分区，PC 随即弹出「无法访问卷」、「需要格式化」等警告，我们一律取消无视。</p><p>此时，TF 卡已经安装上 Raspberry Pi OS 系统了，我们将 TF 卡插入树莓派背面卡槽中，树莓派就已经准备就绪，如果我们为它接上 USB 键盘、鼠标，通过 mini HDMI 接上显示器，再接上网线和电源，就可以像操作其他电脑一样操作树莓派了。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/15/4943eb9579099fa84eaa22184537db6b.gif class=lazyload data-srcset=https://cdn.sspai.com/2021/06/15/4943eb9579099fa84eaa22184537db6b.gif srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/15/4943eb9579099fa84eaa22184537db6b.gif referrerpolicy=no-referrer><figcaption>▲ 图源：<a href="https://www.raspberrypi.org/help/" target=_blank>Raspberry Pi Foundation</a>。</figcaption></figure><p>但我们并非要将树莓派作为主力电脑来使用，完全不需要如此兴师动众地为树莓派搭上这么多配件。我们只需要 TF 卡和电源线，就可以在 PC 上访问和控制树莓派了。如何做到呢？很简单，继续往下看吧。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/15/8f701058a2cedbc5564274dd6b998776.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/15/8f701058a2cedbc5564274dd6b998776.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/15/8f701058a2cedbc5564274dd6b998776.jpg referrerpolicy=no-referrer><figcaption>▲我们只需要 TF 卡和电源线。</figcaption></figure><p>🍎注：在搭载 macOS 的电脑上向 TF 卡烧录系统，思路相同，可使用烧录软件 <a href="https://www.balena.io/etcher/" target=_blank>Etcher</a> 。</p><h2>设置 WiFi 连接和远程访问</h2><p>Raspberry Pi OS 允许我们使用同一个 wifi 下的 PC 来访问和控制树莓派，这个功能叫 SSH 服务。为了使用这个服务来访问树莓派，我们在 PC 上完成对 TF 卡的烧录后，先不要弹出 TF 卡，而是在 PC 上准备两个文件拷贝到 TF 卡中 <sup class=ss-footnote href=https://shumeipai.nxez.com/2017/09/13/raspberry-pi-network-configuration-before-boot.html title="参考：《无屏幕和键盘配置树莓派 WiFi 和 SSH》" footnote-id=2>2</sup>：</p><p>文件 1：我们新建一个 txt 文件，将其命名为「ssh」并删除后缀，注意不是「ssh.txt」。这个文件的作用是让树莓派开启 SSH 功能。</p><p>文件 2：我们同样新建一个 txt 文件，打开输入以下内容：</p><pre class=language-null><code>country=CN
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
 
network=&#123;
ssid="WiFi_Name"
psk="WiFi_PassWord"
key_mgmt=WPA-PSK
priority=1
&#125;</code></pre><p>其中，<code>ssid</code> 是我们家里的 WiFi 名称，<code>psk</code> 是 WiFi 的密码。内容输入完成后保存退出，将文件名称连同后缀修改为「wpa_supplicant.conf」。这个文件的作用是让树莓派按照我们文件中的内容连接 WiFi。</p><ul><li>📖<i></i> 拓展阅读：针对不同 WiFi 加密方式的设置及更多的说明，请查看 <a href=https://shumeipai.nxez.com/2017/09/13/raspberry-pi-network-configuration-before-boot.html target=_blank>此贴</a> 。</li></ul><p>两个文件都准备完成后，将它们拷贝到 TF 卡的 boot 分区根目录下，然后就可以弹出 TF 卡。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/23/05f101f2496241f48673ce25a747273b.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/23/05f101f2496241f48673ce25a747273b.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/23/05f101f2496241f48673ce25a747273b.png referrerpolicy=no-referrer><figcaption>▲将两个文件拷贝到 boot 分区的根目录下，留意两个文件的命名和后缀。</figcaption></figure><p>现在将 TF 卡插入树莓派背面卡槽中，并为树莓派上电。树莓派第一次启动，便会自动读取「wpa_supplicant.conf」文件，按文件内容接入 WiFi，并自动开启 SSH 服务。</p><p>接下来，我们需要知道接入 WiFi 的树莓派在本地局域网中的 ip 地址，以便使用接入同一 WiFi 的 PC 来访问它。我们可以访问无线路由器的管理页面来查找树莓派分配到的 ip 地址：</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/07/05/38f230054a3cc27632ac4cdbeb3e9cf4.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/07/05/38f230054a3cc27632ac4cdbeb3e9cf4.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/07/05/38f230054a3cc27632ac4cdbeb3e9cf4.jpg referrerpolicy=no-referrer><figcaption>▲在无线路由器管理页面，通过接入时间、设备名称和新接入的设备等方法锁定树莓派并查看其 ip 地址。</figcaption></figure><p>现在，我们在 PC 下载并安装用于访问 SSH 服务的工具 <a href=https://www.ssh.com/academy/ssh/putty target=_blank>PuTTY</a><a href="https://pan.baidu.com/share/link?shareid=2217335081&uk=605377859" target=_blank>（懒人直达百度网盘下载</a> ）<sup class=ss-footnote href=https://shumeipai.nxez.com/2013/09/07/using-putty-to-log-in-to-the-raspberry-pie.html title="参考：《使用 PuTTY 登录到树莓派》" footnote-id=3>3</sup>。</p><p>打开 PuTTY，在「主机名称」中输入树莓派在局域网中的 ip 地址，其他选项无序改动，点击「打开」。如果是首次连接此 ip 地址，软件会弹出密钥确认的警告窗，我们点击「是」即可。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/23/201e83e4f413705a83adbc1388c4c396.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/23/201e83e4f413705a83adbc1388c4c396.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/23/201e83e4f413705a83adbc1388c4c396.png referrerpolicy=no-referrer></figure><p>此时软件会弹出命令行窗口：</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/23/9943140633a200d0a828921177943a89.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/23/9943140633a200d0a828921177943a89.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/23/9943140633a200d0a828921177943a89.png referrerpolicy=no-referrer></figure><p>我们在 <code>login as:</code> 中输入 Raspberry Pi OS 默认用户名「pi」然后按回车；接着在 <code>xxx password:</code> 中输入密码「raspberry」按回车。注意输入的密码不会显示在命令行中，所以输入时看到没有反应不必怀疑是否出了问题，大胆输入即可。</p><p>看到窗口显示 <code>pi@raspberrypi:~ $</code>，说明我们已经登录到树莓派了。现在我们就可以通过各种 Linux 指令来控制树莓派啦。</p><p>🍎 注：在搭载 macOS 的电脑上通过 SSH 服务登录树莓派，可使用 <a href=https://www.ssh.com/academy/ssh/putty/mac target=_blank>PuTTY on Mac</a> 。</p><h2>远程访问树莓派桌面</h2><p>虽然我们在 PC 成功登录到树莓派，但进入的是它的命令行界面。作为新手的我们，当然还是希望能够访问更加熟悉的图形化桌面。这是没问题的，这次我们要用到的是 Raspberry Pi OS 的 VNC 服务 <sup class=ss-footnote href=https://shumeipai.nxez.com/2018/08/31/raspberry-pi-vnc-viewer-configuration-tutorial.html title="参考：《树莓派 VNC Viewer 远程桌面配置教程》" footnote-id=4>4</sup>。</p><p>首先需要开启 VNC 服务，我们在 PC 上通过 SSH 登录到树莓派命令行窗口，输入以下指令进入 Raspberry Pi OS 的配置页面：</p><pre class=language-null><code>sudo raspi-config</code></pre><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/21/3d89ef3d6fed01cbfee681a38cd68f53.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/21/3d89ef3d6fed01cbfee681a38cd68f53.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/21/3d89ef3d6fed01cbfee681a38cd68f53.png referrerpolicy=no-referrer><figcaption>▲Raspberry Pi OS 配置页面</figcaption></figure><p>在配置页面，依次选择「3 Interface Options」>「P3 VNC」，按回车，界面提示「Would you like the VNC server to be enabled?」，选择「Yes」即可开启 VNC 服务。此后系统自动返回到配置页面，选择「Finish」退出配置页面，返回命令行窗口。</p><p>接下来，我们在 PC 下载并安装用于访问 VNC 的客户端 <a href="https://www.realvnc.com/en/connect/download/viewer/" target=_blank>VNC Viewer</a>。</p><p>打开 VNC Viewer，在顶部 ip 地址框中输入树莓派在局域网中的 ip 地址，按回车连接，首次连接照例弹出安全警告，我们照例同意。此时软件弹出授权窗口，我们输入账号密码后点「OK」，软件就成功远程登录到树莓派的图形化桌面啦。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/21/ccd6136872f06854dcdf7243b3a0d209.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/21/ccd6136872f06854dcdf7243b3a0d209.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/21/ccd6136872f06854dcdf7243b3a0d209.png referrerpolicy=no-referrer></figure><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/21/ad9497098d988cdd36920c454aa748b9.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/21/ad9497098d988cdd36920c454aa748b9.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/21/ad9497098d988cdd36920c454aa748b9.png referrerpolicy=no-referrer><figcaption>▲熟悉的图形化桌面</figcaption></figure><p>🍎 注：在搭载 macOS 的电脑上通过 VNC 服务登录树莓派桌面，可使用 <a href="https://www.realvnc.com/en/connect/download/viewer/macos/" target=_blank>VNC Viewer for macO</a><a target=_blank rel=noopener href="https://www.realvnc.com/en/connect/download/viewer/macos/">S</a> 。</p><p>接下来介绍在 PC 通过 VNC Viewer 远程访问树莓派桌面经常会遇到的两个问题以及它们的解决方法。</p><h3>如何解决「cannot currently show the desktop」问题</h3><p>我们按照上述步骤操作，可能会遇到以下问题：成功在 VNC Viewer 中连接到树莓派，但是弹出的窗口却是黑屏，并显示「cannot currently show the desktop」。</p><figure class="image ss-img-wrapper image_resized" style=width:435px;><img src=https://cdn.sspai.com/2021/06/23/c85a62143a96ef98d1e9d49c39396988.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/23/c85a62143a96ef98d1e9d49c39396988.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/23/c85a62143a96ef98d1e9d49c39396988.png referrerpolicy=no-referrer></figure><p>这是由于 Raspberry Pi OS 的桌面分辨率不合适导致的。解决方法很简单：</p><p>使用 PuTTY 登陆到树莓派命令行窗口，同样输入 <code>sudo raspi-config</code> 进入配置界面，依次选择「2 Display Options」>「D1 Resolution」，然后选择 1280×720 或 1920×1080 等分辨率，保存退出。在 VNC Viewer 中重新进行连接，就可以成功显示桌面啦。</p><h3>如何调整 VNC Viewer 显示树莓派桌面的分辨率</h3><p>紧接上一个问题，我们明明已经在配置中将 Raspberry Pi OS 的桌面分辨率设置为 1920×1080 的分辨率了，为什么我们在 PC 的 VNC Viewer 上访问桌面时，分辨率仍然很低呢：</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/21/4c2a7d8f0347daeaf3409d065db37d9a.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/21/4c2a7d8f0347daeaf3409d065db37d9a.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/21/4c2a7d8f0347daeaf3409d065db37d9a.jpg referrerpolicy=no-referrer><figcaption>▲在 PC 通过 VNC Viewer 访问树莓派桌面，即使最大化窗口，画面也无法填满 PC 屏幕</figcaption></figure><p>这是由于我们虽然修改了 Raspberry Pi OS 的桌面分辨率，但却没有修改 VNC 服务的分辨率所导致的。经过调研，有一个解决方法：</p><p>我们在命令行窗口中（可以使用 PuTTY 登录命令行窗口，或者在 VNC Viewer 所连接的桌面上打开命令行窗口）执行以下指令：</p><pre class=language-null><code>vncserver -geometry 1920x1080</code></pre><p>这句指令的作用是将 VNC 服务的显示分辨率修改为 1920×1080。执行后，树莓派提示生成了另一个端口「ip 地址:1」供 VNC Viewer 连接。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/21/56e42b1497cc20c347f29aa7b046abea.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/21/56e42b1497cc20c347f29aa7b046abea.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/21/56e42b1497cc20c347f29aa7b046abea.png referrerpolicy=no-referrer></figure><p>我们在 VNC Viewer 中输入新端口地址「ip 地址:1」来连接，输入账号密码登录，这个窗口的分辨率就是 1920×1080 啦。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/21/082b63caf851213a93fb76c398888e47.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/21/082b63caf851213a93fb76c398888e47.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/21/082b63caf851213a93fb76c398888e47.png referrerpolicy=no-referrer></figure><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/21/20eb56adc1dcec6a1cd959bb8f2328fa.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/21/20eb56adc1dcec6a1cd959bb8f2328fa.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/21/20eb56adc1dcec6a1cd959bb8f2328fa.jpg referrerpolicy=no-referrer><figcaption>▲现在 VNC Viewer 访问到的树莓派桌面分辨率才是 1920×1080</figcaption></figure><p>不过新的窗口显示的鼠标指针变成了「×」号。我们在新窗口的命令行中执行第二句指令：</p><pre class=language-null><code>lxappearance</code></pre><p>即可将鼠标指针切换回熟悉的箭头。</p><h2>在 PC 和树莓派之间传输文件</h2><p>我们已经可以很方便地在 PC 上访问树莓派的命令行窗口和桌面了。现在，我们来搭建在 PC 和树莓派之间传输文件的功能，我们会在树莓派上搭建一个 FTP 服务器，所用到的工具是 vsftpd，一款运行于类 UNIX 系统上的 FTP 服务器。</p><p>我们打开树莓派的命令行窗口（再复习一遍：我们可以使用 PuTTY 登录命令行窗口，或者使用 VNC Viewer 登录到桌面，然后打开命令行窗口），输入以下指令来安装 vsftpd：</p><pre class=language-null><code>sudo apt-get install -y vsftpd</code></pre><p>安装完毕后，输入指令打开 vsftpd 的配置文件，进行一些必要的设置：</p><pre class=language-null><code>sudo nano /etc/vsftpd.conf</code></pre><p>在打开的配置文件中，我们将以下内容前的#号去掉，来让这行内容生效：</p><pre class=language-null><code>anonymous_enable=NO
local_enable=YES
write_enable=YES
local_umask=022</code></pre><p>完成后，按「ctrl+o」保存文件，再按「ctrl+x」退出文件编辑，返回命令行窗口。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/23/331fe4c8698c0c8f05e073163954fe37.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/23/331fe4c8698c0c8f05e073163954fe37.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/23/331fe4c8698c0c8f05e073163954fe37.png referrerpolicy=no-referrer><figcaption>▲「vsftpd.conf」文件修改前</figcaption></figure><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/23/7b5e93a3bbdcd83f78a3065afd854ded.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/23/7b5e93a3bbdcd83f78a3065afd854ded.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/23/7b5e93a3bbdcd83f78a3065afd854ded.png referrerpolicy=no-referrer><figcaption>▲「vsftpd.conf」文件修改后</figcaption></figure><ul><li>📖<i></i> 拓展阅读：这些内容的作用如下：</li></ul><figure class=table><table><tbody><tr><td>anonymous_enable=NO</td><td>不允许匿名用户访问我们所搭建的 FTP 服务器</td></tr><tr><td>local_enable=YES</td><td>允许本地用户访问 FTP 服务器</td></tr><tr><td>write_enable=YES</td><td>允许向 FTP 服务器执行写入操作</td></tr><tr><td>local_umask=022</td><td>设定上传后文件的权限掩码</td></tr></tbody></table></figure><p>随后，在命令行窗口中输入指令启动 vsftpd 服务：</p><pre class=language-null><code>sudo service vsftpd start</code></pre><p>在树莓派上的操作就已经完成了，树莓派上现在已经搭建了一个 FTP 服务器。</p><p>现在，我们在 PC 下载并安装用于访问 FTP 服务器的客户端 <a href=https://www.filezilla.cn/download target=_blank>FileZilla</a>。</p><p>打开 FileZilla，在顶部「主机」地址框中输入树莓派在局域网中的 ip 地址、用户名和密码，端口为 22。然后点击「快速连接」。连接成功后，我们就可以在「远程站点」中看到树莓派的文件目录了。现在，我们就可以很方便地通过拖拽在 PC 和树莓派之间双向传输文件了，十分方便。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/23/55ce11f2c78d1b15a7cc6b8966a54334.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/23/55ce11f2c78d1b15a7cc6b8966a54334.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/23/55ce11f2c78d1b15a7cc6b8966a54334.png referrerpolicy=no-referrer></figure><p>🍎 注：在搭载 macOS 的电脑上访问树莓派的 FTP 服务器，使用 <a href=https://www.filezilla.cn/download/client target=_blank>FileZilla MACOSX X8</a><a target=_blank rel=noopener href=https://www.filezilla.cn/download/client>6</a> 。</p><h2>备份树莓派系统</h2><p>现在，我们已经可以很方便地在 PC 上访问和控制树莓派，并进行文件传输，我们的树莓派折腾之旅就正式开始了。在折腾树莓派的过程中，我们少不了在系统中安装和配置各种软件、Python 库、环境依赖等等。搞机是有风险的，为了在我们将系统折腾翻车的时候有一个撤回的机会，我们可以在适当的时候对系统进行备份，以备有需要时可以恢复系统。在本教程最后一个内容里，我们来看看如何备份树莓派的系统。</p><p>根据调研和实测，目前有两种备份树莓派系统的方法，它们有各自的适用范围。以下分别介绍这两种方法。</p><h3>对 TF 卡进行完整备份</h3><p>我们在 PC 上用来向 TF 卡烧录系统的软件 Win32DiskImager，也可以用来将 TF 卡上的系统完整备份为一个镜像文件。</p><p>我们把树莓派关机后，将 TF 卡拔出，通过读卡器连到 PC 上（照例忽视系统弹出的「需要格式化」等警告）。在 PC 上打开 Win32DiskImager，在「映像文件」中选择准备存放镜像文件的路径，并输入镜像文件名称和「.img」后缀。确认「设备」选中的是 TF 卡 boot 分区对应的盘符，然后点击「读取」，此时软件会从「设备」向「映像文件」传输文件，完成后，TF 卡上的树莓派系统就备份到 <code>D:/Raspberry Pi/systemBackUp.img</code> 这个镜像文件中了。</p><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/06/26/e858975b4ba17be316a69c98a4a823f8.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/06/26/e858975b4ba17be316a69c98a4a823f8.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/06/26/e858975b4ba17be316a69c98a4a823f8.png referrerpolicy=no-referrer></figure><p>现在，我们就将树莓派现在的系统完整备份到了这个镜像文件。想恢复这个系统时，我们只需要将 TF 卡格式化之后，按照上文「2. 烧录树莓派系统」中的操作，将此镜像文件烧录到 TF 卡中即可。</p><p>推荐大家使用 <a href="https://www.sdcardformatter.com/download/" target=_blank>SD Card Formatter</a> 来格式化 TF 卡，有 Windows 和 MacOS 版本。它可以十分方便、干净完成对 TF 卡的格式化，不容易误格式化其他硬盘。</p><figure class="image ss-img-wrapper image_resized" style=width:356px;><img src=https://cdn.sspai.com/2021/07/05/5e439e86cd2718d4f5793aa516d990b8.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/07/05/5e439e86cd2718d4f5793aa516d990b8.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/07/05/5e439e86cd2718d4f5793aa516d990b8.png referrerpolicy=no-referrer><figcaption>无需其他设置，直接按「Format」即可完成格式化。</figcaption></figure><p>这个备份系统的方法操作简单，但是它的缺点是需要将 TF 卡完整备份，所生成的镜像文件体积等于 TF 卡的容量。因此这种方法比较适用于对小容量 TF 卡（≤ 16 GB）的备份，对于大容量的 TF 卡（比如 ≥ 128 GB），每次备份都会产生一个 128 GB 的镜像文件，这显然是不科学的。这就引出了我们的第二个备份方法。</p><h3>使用 rpi-backup 脚本进行备份</h3><p>这种方法使用大佬编写的 rpi-backup 脚本对树莓派系统进行备份。这个备份方法所生成的镜像文件体积是系统已用空间的 1.2 倍，相比于第一种备份方法，这种方法可以显著缩小镜像文件的体积，节省镜像文件所占用的磁盘空间。</p><p>这个备份方案需要在树莓派上操作。我们需要将 rpi-backup 脚本文件拷贝到树莓派中。我们登录到树莓派命令行窗口，执行以下指令来从 Github 克隆脚本文件到树莓派上：</p><pre class=language-null><code>git clone https://github.com/nanhantianyi/rpi-backup.git</code></pre><p>我们也可以在 PC 上从 Github 下载 <a href=https://github.com/nanhantianyi/rpi-backup target=_blank>脚本</a> 并将其通过 ftp 传输到到树莓派中。</p><p>接下来，在树莓派命令行窗口中执行 cd 指令跳转到脚本所在的路径，比如我将脚本文件存放在 <code>pi/Downloads/rpi-backup-master</code> 路径下：</p><pre class=language-null><code>cd Downloads/rpi-backup-master</code></pre><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/07/05/7a7d812bbf34e4599a8e7f6ecbbe5da1.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/07/05/7a7d812bbf34e4599a8e7f6ecbbe5da1.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/07/05/7a7d812bbf34e4599a8e7f6ecbbe5da1.png referrerpolicy=no-referrer><figcaption>脚本文件所在的路径</figcaption></figure><figure class="image ss-img-wrapper"><img src=https://cdn.sspai.com/2021/07/05/07945fdefee97ce2168b50ac5990fb4f.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 class=lazyload data-srcset=https://cdn.sspai.com/2021/07/05/07945fdefee97ce2168b50ac5990fb4f.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1 srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-original=https://cdn.sspai.com/2021/07/05/07945fdefee97ce2168b50ac5990fb4f.png referrerpolicy=no-referrer><figcaption>▲利用 cd 指令进入到脚本文件所在路径中</figcaption></figure><p>现在，在此路径下执行以下指令即可执行「back.sh」脚本来将树莓派系统备份为镜像文件：</p><pre class=language-null><code>sudo bash back.sh xxx.img</code></pre><p>其中「xxx」为镜像文件名称。所生成的镜像文件将存放在「back.sh」同一路径下。我们可以修改「xxx」内容来指定镜像文件的存放路径和名称，如 <code>Documents/systemBackUp.img</code> 等。恢复系统时，同样只需要将 TF 卡格式化，然后将备份的镜像文件烧录到 TF 卡中即可。</p><p>我使用这个方法对我的树莓派的系统进行备份，结果如下：</p><figure class=table><table><thead><tr><th>项目</th><th>体积</th></tr></thead><tbody><tr><td>TF 卡</td><td>32 GB</td></tr><tr><td>系统已用空间</td><td>6.7 GB</td></tr><tr><td>备份系统后生成的镜像文件</td><td>8.3 GB</td></tr></tbody></table></figure><p>可以看到， 镜像文件体积大约是系统已用空间的 1.24 倍，远小于 TF 卡的容量。</p><p>这种备份方法并非没有缺点。它所生成的镜像文件是保存 TF 卡中的，如果 TF 卡容量不大，剩余的空间不多，我们需要将硬盘挂载到树莓派上合适的目录下，然后将镜像文件保存到硬盘中，这些操作可能对新手不太友好。因此，大家根据自己实际情况选择合适自己的系统备份方法吧。</p><h2>尾声</h2><p>2021 年的树莓派入坑指南至此接近尾声，我们通过下表来回顾、概括一下本文涉及的操作：</p><figure class=table><table><thead><tr><th>操作</th><th>实现途径</th><th>所用的工具 / 软件</th></tr></thead><tbody><tr><td>烧录树莓派系统</td><td>\</td><td><a href=https://make.quwj.com/bookmark/327/go target=_blank>Win32DiskImager</a>、<a href="https://www.balena.io/etcher/" target=_blank>Etcher</a></td></tr><tr><td>在 PC 访问树莓派命令行窗口</td><td>SSH</td><td><a href=https://www.ssh.com/academy/ssh/putty target=_blank>PuTTY</a></td></tr><tr><td>在 PC 访问树莓派图形化界面</td><td>VNC</td><td><a href="https://www.realvnc.com/en/connect/download/viewer/" target=_blank>VNC Viewer</a></td></tr><tr><td>在 PC 和树莓派之间传输文件</td><td>FTP</td><td><a href=https://www.filezilla.cn/download target=_blank>FileZilla</a></td></tr><tr><td>备份树莓派系统</td><td>\</td><td><a href=https://make.quwj.com/bookmark/327/go target=_blank>Win32DiskImager</a>、<a href=https://github.com/nanhantianyi/rpi-backup target=_blank>rpi-backup 脚本</a></td></tr><tr><td>恢复树莓派系统</td><td>\</td><td><a href=https://make.quwj.com/bookmark/327/go target=_blank>Win32DiskImager</a>、<a href="https://www.balena.io/etcher/" target=_blank>Etcher</a></td></tr></tbody></table></figure><p>希望本文能对大家有所帮助。如果你有好用的树莓派使用技巧，欢迎在评论区分享、讨论哟。</p><p>> 下载少数派 <a target=_blank rel=noopener href=https://sspai.com/page/client>客户端</a> 、关注 <a target=_blank rel=noopener href=https://sspai.com/s/J71e>少数派公众号</a> ，了解更妙的数字生活 🍃</p><p>> 想申请成为少数派作者？<a href=https://sspai.com/apply/writing target=_blank>冲！</a></p></div></div><div style="border:1px solid transparent;" data-v-e1f0100a></div><div class="article-side sideTop" style=display:none;left:0; data-v-7be936cf data-v-e1f0100a><div class=download-guide-container data-v-14f9065e data-v-7be936cf><div class=btn-wrapper data-v-14f9065e><button class="btn btn-view" data-v-14f9065e><i class="iconfont iconfont-phone" data-v-14f9065e></i></button></div><a href=https://sspai.com/s/JYjP target=_blank data-v-14f9065e></a></div><div class=item-wrapper data-v-7be936cf><button class="btn btn-charge" data-v-7be936cf><i class=iconfont data-v-7be936cf></i></button><span class=count data-v-7be936cf>161</span></div><div class=item-wrapper data-v-7be936cf><button class="btn-mini btn-comment" data-v-7be936cf><i class="iconfont iconfont-comment" data-v-7be936cf></i></button><span class=count data-v-7be936cf>47</span></div><div class=item-wrapper data-v-7be936cf><span data-v-7be936cf><div role=tooltip id=el-popover-7619 aria-hidden=true class="el-popover el-popper popper-share right ss-popper-dark-border" style=width:undefinedpx;display:none;><div class=article-side-share-btn><a href="https://service.weibo.com/share/share.php?url=null?ref=weibo&title=%E3%80%902021%EF%BC%9A%E6%A0%91%E8%8E%93%E6%B4%BE%E5%85%A5%E5%9D%91%E6%8C%87%E5%8D%97%E3%80%91%E5%89%8D%E8%A8%80%E6%A0%91%E8%8E%93%E6%B4%BE%E6%98%AF%E5%8F%AA%E6%9C%89%E4%BF%A1%E7%94%A8%E5%8D%A1%E5%A4%A7%E5%B0%8F%E3%80%81%E5%8F%AF%E8%BF%90%E8%A1%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA1%E3%80%82%E7%AC%AC%E4%B8%80%E6%AC%BE%E6%A0%91%E8%8E%93%E6%B4%BE%E4%BA%8E2012%E5%B9%B4%E5%8F%91%E5%94%AE%EF%BC%8C%E8%87%B3%E4%BB%8A%E5%B7%B2%E6%9C%899%E5%B9%B4%E3%80%829%E5%B9%B4%E9%97%B4%EF%BC%8C%E5%A4%A7%E5%A4%A7%E5%B0%8F%E5%B0%8F%E3%80%81%E7%A8%80%E5%A5%87%E5%8F%A4%E6%80%AA%E7%9A%84%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A1%B9%E7%9B%AE%E9%81%8D%E5%9C%B0%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&pic=https%3A%2F%2Fcdn.sspai.com%2F2021%2F07%2F05%2F18926bff71d77788efd80ee8c8f38520.jpg%3FimageMogr2%2Fauto-orient%2Fquality%2F95%2Fthumbnail%2F!1420x708r%2Fgravity%2FCenter%2Fcrop%2F1420x708%2Finterlace%2F1&appkey=3196502474#" target=_blank><i class="icon icon-article_weibo right-16"></i></a><span><div role=tooltip id=el-popover-9377 aria-hidden=true class="el-popover el-popper" style=width:undefinedpx;display:none;><div style=text-align:center;><div id=qr-code></div><small class=qr-small>扫码分享</small></div></div><span class=el-popover__reference-wrapper><i class="icon icon-article_weixin right-16"></i></span></span><a href="https://twitter.com/share?text=%E3%80%902021%EF%BC%9A%E6%A0%91%E8%8E%93%E6%B4%BE%E5%85%A5%E5%9D%91%E6%8C%87%E5%8D%97%E3%80%91%E5%89%8D%E8%A8%80%E6%A0%91%E8%8E%93%E6%B4%BE%E6%98%AF%E5%8F%AA%E6%9C%89%E4%BF%A1%E7%94%A8%E5%8D%A1%E5%A4%A7%E5%B0%8F%E3%80%81%E5%8F%AF%E8%BF%90%E8%A1%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA1%E3%80%82%E7%AC%AC%E4%B8%80%E6%AC%BE%E6%A0%91%E8%8E%93%E6%B4%BE%E4%BA%8E2012%E5%B9%B4%E5%8F%91%E5%94%AE%EF%BC%8C%E8%87%B3%E4%BB%8A%E5%B7%B2%E6%9C%899%E5%B9%B4%E3%80%829%E5%B9%B4%E9%97%B4%EF%BC%8C%E5%A4%A7%E5%A4%A7%E5%B0%8F%E5%B0%8F%E3%80%81%E7%A8%80%E5%A5%87%E5%8F%A4%E6%80%AA%E7%9A%84%E6%A0%91%E8%8E%93%E6%B4%BE%E9%A1%B9%E7%9B%AE%E9%81%8D%E5%9C%B0%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&url=null" target=_blank class=twitter><i class="icon icon-article_twitter right-16"></i></a></div></div><span class=el-popover__reference-wrapper><button class="btn-mini btn-share" data-v-7be936cf><i class="iconfont iconfont-share" data-v-7be936cf></i></button></span></span></div><div class=item-wrapper data-v-7be936cf><button class="btn-mini btn-collect" data-v-7be936cf><i class="iconfont iconfont-collect" data-v-7be936cf></i></button></div></div></div><div class=footer><div class=copyright><blockquote><p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p><p>本文永久链接是：<a href=https://news.slqwq.cn/p/564c.html>https://news.slqwq.cn/p/564c.html</a></p></blockquote></div></div><div class=article-meta id=bottom><div class=new-meta-box><div class="new-meta-item date" itemprop=dateUpdated datetime=2021-07-11T00:45:17+00:00><a class=notlink><i class="fas fa-edit fa-fw" aria-hidden=true></i><p>更新于：2021年7月11日</p></a></div><div class="new-meta-item share -mob-share-list"><div class="-mob-share-list share-body"><a class=-mob-share-qq rel="external nofollow noopener noreferrer noopener" target=_blank href="http://connect.qq.com/widget/shareqq/index.html?url=https://news.slqwq.cn/p/564c.html&title=2021：树莓派入坑指南 - Hajeekn RSSHUB&pics=https://cdn.sspai.com/2021/06/15/3060e23855b927fd73c99f533d37da74.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1&summary="><img src=https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qq.png class=lazyload data-srcset=https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qq.png srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></a> <a class=-mob-share-qzone rel="external nofollow noopener noreferrer noopener" target=_blank href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://news.slqwq.cn/p/564c.html&title=2021：树莓派入坑指南 - Hajeekn RSSHUB&pics=https://cdn.sspai.com/2021/06/15/3060e23855b927fd73c99f533d37da74.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1&summary="><img src=https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qzone.png class=lazyload data-srcset=https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qzone.png srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></a> <a class=-mob-share-weibo rel="external nofollow noopener noreferrer noopener" target=_blank href="http://service.weibo.com/share/share.php?url=https://news.slqwq.cn/p/564c.html&title=2021：树莓派入坑指南 - Hajeekn RSSHUB&pics=https://cdn.sspai.com/2021/06/15/3060e23855b927fd73c99f533d37da74.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1&summary="><img src=https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/weibo.png class=lazyload data-srcset=https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/weibo.png srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></a></div></div></div></div><div class=prev-next><a class=prev href=/p/4512.html><p class=title><i class="fas fa-chevron-left" aria-hidden=true></i>万科A：2021年6月销售及近期新增项目情况简报 网页链接</p><p class=content>万科A：2021年6月销售及近期新增项目情况简报 网页链接</p></a><a class=next href=/p/b8ac.html><p class=title>1491._格雷厄姆_与_查理芒格_，谁是真正的大宗师？(上)<i class="fas fa-chevron-right" aria-hidden=true></i></p><p class=content>在网页中查看</p></a></div></article></div><aside class=l_side><section class="widget toc-wrapper shadow desktop mobile" id=toc-div><header><i class="fas fa-list fa-fw" aria-hidden=true></i> <span class=name>本文目录</span></header><div class=content><ol class=toc><li class="toc-item toc-level-3"><a class=toc-link><span class=toc-text>专栏文章 首页推荐</span></a></li></ol><li class="toc-item toc-level-2"><a class=toc-link><span class=toc-text>前言</span></a></li><li class="toc-item toc-level-2"><a class=toc-link><span class=toc-text>购买树莓派和配件</span></a></li><li class="toc-item toc-level-2"><a class=toc-link><span class=toc-text>烧录树莓派系统</span></a></li><li class="toc-item toc-level-2"><a class=toc-link><span class=toc-text>设置 WiFi 连接和远程访问</span></a></li><li class="toc-item toc-level-2"><a class=toc-link><span class=toc-text>远程访问树莓派桌面</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link><span class=toc-text>如何解决「cannot currently show the desktop」问题</span></a></li><li class="toc-item toc-level-3"><a class=toc-link><span class=toc-text>如何调整 VNC Viewer 显示树莓派桌面的分辨率</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link><span class=toc-text>在 PC 和树莓派之间传输文件</span></a></li><li class="toc-item toc-level-2"><a class=toc-link><span class=toc-text>备份树莓派系统</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link><span class=toc-text>对 TF 卡进行完整备份</span></a></li><li class="toc-item toc-level-3"><a class=toc-link><span class=toc-text>使用 rpi-backup 脚本进行备份</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link><span class=toc-text>尾声</span></a></li></div></section></aside><script>
  window.pdata={}
  pdata.ispage=true;
  pdata.postTitle="2021：树莓派入坑指南";
  pdata.commentPath="";
  pdata.commentPlaceholder="";
  // header 这里无论是否开启pjax都需要
  var l_header=document.getElementById("l_header");
  
  l_header.classList.add("show");
  
  
    // cover
    var cover_wrapper=document.querySelector('.cover-wrapper');
    
    cover_wrapper.id="none";
    cover_wrapper.style.display="none";
    
  
</script></div><footer class="footer clearfix"><br><br><div class=aplayer-container></div><br><div class=social-wrapper></div><div><p>博客内容遵循 <a target=_blank rel=noopener href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p></div><div><p><span id=lc-sv>本站总访问量为<span id=number><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden=true></i></span> 次</span> <span id=lc-uv>访客数为<span id=number><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden=true></i></span> 人</span></p></div>本站使用 <a href=https://github.com/volantis-x/hexo-theme-volantis/tree/4.3.1 target=_blank class=codename>Volantis</a> 作为主题<div class=copyright><p><a href="/">Copyright © 2017-2020 XXX</a></p></div></footer><a id=s-top class="fas fa-arrow-up fa-fw" href=javascript:void(0)></a></div></div><div><script>
/************这个文件存放不需要重载的全局变量和全局函数*********/
window.volantis={};
window.volantis.loadcss=document.getElementById("loadcss");
/******************** Pjax ********************************/
function VPjax(){
	this.list=[] // 存放回调函数
	this.start=()=>{
	  for(var i=0;i<this.list.length;i++){
		this.list[i].run();
	  }
	}
	this.push=(fn,name)=>{
		var f=new PjaxItem(fn,name);
		this.list.push(f);
	}
	// 构造一个可以run的对象
	function PjaxItem(fn,name){
		// 函数名称
		this.name = name || fn.name
		// run方法
		this.run=()=>{
			fn()
		}
	}
}
volantis.pjax={}
volantis.pjax.method={
	complete: new VPjax(),
	error: new VPjax(),
	send: new VPjax()
}
volantis.pjax={
	...volantis.pjax,
	push: volantis.pjax.method.complete.push,
	error: volantis.pjax.method.error.push,
	send: volantis.pjax.method.send.push
}
/********************脚本懒加载函数********************************/
// 已经加入了setTimeout
function loadScript(src, cb) {
	setTimeout(function() {
		var HEAD = document.getElementsByTagName('head')[0] || document.documentElement;
		var script = document.createElement('script');
		script.setAttribute('type','text/javascript');
		if (cb) script.onload = cb;
		script.setAttribute('src', src);
		HEAD.appendChild(script);
	});
}
//https://github.com/filamentgroup/loadCSS
var loadCSS = function( href, before, media, attributes ){
	var doc = window.document;
	var ss = doc.createElement( "link" );
	var ref;
	if( before ){
		ref = before;
	}
	else {
		var refs = ( doc.body || doc.getElementsByTagName( "head" )[ 0 ] ).childNodes;
		ref = refs[ refs.length - 1];
	}
	var sheets = doc.styleSheets;
	if( attributes ){
		for( var attributeName in attributes ){
			if( attributes.hasOwnProperty( attributeName ) ){
				ss.setAttribute( attributeName, attributes[attributeName] );
			}
		}
	}
	ss.rel = "stylesheet";
	ss.href = href;
	ss.media = "only x";
	function ready( cb ){
		if( doc.body ){
			return cb();
		}
		setTimeout(function(){
			ready( cb );
		});
	}
	ready( function(){
		ref.parentNode.insertBefore( ss, ( before ? ref : ref.nextSibling ) );
	});
	var onloadcssdefined = function( cb ){
		var resolvedHref = ss.href;
		var i = sheets.length;
		while( i-- ){
			if( sheets[ i ].href === resolvedHref ){
				return cb();
			}
		}
		setTimeout(function() {
			onloadcssdefined( cb );
		});
	};
	function loadCB(){
		if( ss.addEventListener ){
			ss.removeEventListener( "load", loadCB );
		}
		ss.media = media || "all";
	}
	if( ss.addEventListener ){
		ss.addEventListener( "load", loadCB);
	}
	ss.onloadcssdefined = onloadcssdefined;
	onloadcssdefined( loadCB );
	return ss;
};
</script><script>
  
  loadCSS("https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14/css/all.min.css", window.volantis.loadcss);
  
  
  
  
</script><script src=https://cdn.jsdelivr.net/npm/jquery@3.5/dist/jquery.min.js></script><script>
  function pjax_fancybox() {
    $(".md .gallery").find("img").each(function () { //渲染 fancybox
      var element = document.createElement("a"); // a 标签
      $(element).attr("class", "fancybox");
      $(element).attr("pjax-fancybox", "");  // 过滤 pjax
      $(element).attr("href", $(this).attr("src"));
      if ($(this).attr("data-original")) {
        $(element).attr("href", $(this).attr("data-original"));
      }
      $(element).attr("data-fancybox", "images");
      var caption = "";   // 描述信息
      if ($(this).attr('alt')) {  // 判断当前页面是否存在描述信息
        $(element).attr('data-caption', $(this).attr('alt'));
        caption = $(this).attr('alt');
      }
      var div = document.createElement("div");
      $(div).addClass("fancybox");
      $(this).wrap(div); // 最外层套 div ，其实主要作用还是 class 样式
      var span = document.createElement("span");
      $(span).addClass("image-caption");
      $(span).text(caption); // 加描述
      $(this).after(span);  // 再套一层描述
      $(this).wrap(element);  // 最后套 a 标签
    })
    $(".md .gallery").find("img").fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
      closeClick: true,
      helpers: {
        overlay: {closeClick: true}
      },
      buttons: [
        "zoom",
        "close"
      ]
    });
  };
  function SCload_fancybox() {
    if ($(".md .gallery").find("img").length == 0) return;
    loadCSS("https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css", document.getElementById("loadcss"));
    loadScript('https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js', pjax_fancybox)
  };
  $(function () {
    SCload_fancybox();
  });
  function Pjax_SCload_fancybox(){
	if (typeof $.fancybox == "undefined") {
	 SCload_fancybox();
    } else {
	 pjax_fancybox();
    }
  }
  volantis.pjax.push(Pjax_SCload_fancybox)
  volantis.pjax.send(()=>{
      if (typeof $.fancybox != "undefined") {
        $.fancybox.close();    // 关闭弹窗
      }
  },'fancybox')
</script><script>
  function loadIssuesJS() {
    if ($(".md").find(".issues-api").length == 0) return;
	
	  loadScript('/js/issues.js');
	
  };
  $(function () {
    loadIssuesJS();
  });
  volantis.pjax.push(()=>{
	if (typeof IssuesAPI == "undefined") {
	  loadIssuesJS();
	}
  },"IssuesJS")
</script><script defer src=https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.min.js></script><script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
  document.addEventListener('pjax:complete', function () {
    lazyLoadInstance.update();
  });
</script><script>
  window.FPConfig = {
	delay: 0,
	ignoreKeywords: [],
	maxRPS: 5,
	hoverDelay: 25
  };
</script><script defer src=https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js></script><script src=/js/valine.js></script><script>
  function emoji(path, idx, ext) {
    return path + "/" + path + "-" + idx + "." + ext;
  }
  var emojiMaps = {};
  for (var i = 1; i <= 54; i++) {
    emojiMaps['tieba-' + i] = emoji('tieba', i, 'png');
  }
  for (var i = 1; i <= 101; i++) {
    emojiMaps['qq-' + i] = emoji('qq', i, 'gif');
  }
  for (var i = 1; i <= 116; i++) {
    emojiMaps['aru-' + i] = emoji('aru', i, 'gif');
  }
  for (var i = 1; i <= 125; i++) {
    emojiMaps['twemoji-' + i] = emoji('twemoji', i, 'png');
  }
  for (var i = 1; i <= 4; i++) {
    emojiMaps['weibo-' + i] = emoji('weibo', i, 'png');
  }
  function pjax_valine() {
    if(!document.querySelectorAll("#valine_container")[0])return;
    let pagePlaceholder = pdata.commentPlaceholder || "快来评论吧~";
    let path = pdata.commentPath;
    if (path.length == 0) {
      let defaultPath = '';
      path = defaultPath || decodeURI(window.location.pathname);
    }
    var valine = new Valine();
    valine.init(Object.assign({"path":null,"placeholder":"快来评论吧~","appId":null,"appKey":null,"meta":["nick","mail","link"],"requiredFields":["nick","mail"],"enableQQ":true,"recordIP":false,"avatar":"robohash","pageSize":10,"lang":"zh-cn","highlight":true,"mathJax":false}, {
      el: '#valine_container',
      path: path,
      placeholder: pagePlaceholder,
      emojiCDN: 'https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/valine/',
      emojiMaps: emojiMaps,
    }))
  }
  $(function () {
    pjax_valine();
  });
  volantis.pjax.push(pjax_valine);
</script><script src=/js/app.js></script><script>
const SearchServiceimagePath="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@master/img/";
const ROOT =  ("/" || "/").endsWith('/') ? ("/" || "/") : ("//" || "/" );

$('.input.u-search-input').one('focus',function(){
	
		loadScript('/js/search/hexo.js',setSearchService);
	
})

function listenSearch(){
  
    customSearch = new HexoSearch({
      imagePath: SearchServiceimagePath
    });
  
}
function setSearchService() {
	listenSearch();
	
}
</script><script defer>

  const LCCounter = {
    app_id: 'u9j57bwJod4EDmXWdxrwuqQT-MdYXbMMI',
    app_key: 'jfHtEKVE24j0IVCGHbvuFClp',
    custom_api_server: '',

    // 查询存储的记录
    getRecord(Counter, url, title) {
      return new Promise(function (resolve, reject) {
        Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({url})))
          .then(resp => resp.json())
          .then(({results, code, error}) => {
            if (code === 401) {
              throw error;
            }
            if (results && results.length > 0) {
              var record = results[0];
              resolve(record);
            } else {
              Counter('post', '/classes/Counter', {url, title: title, times: 0})
                .then(resp => resp.json())
                .then((record, error) => {
                  if (error) {
                    throw error;
                  }
                  resolve(record);
                }).catch(error => {
                console.error('Failed to create', error);
                reject(error);
              });
            }
          }).catch((error) => {
          console.error('LeanCloud Counter Error:', error);
          reject(error);
        });
      })
    },

    // 发起自增请求
    increment(Counter, incrArr) {
      return new Promise(function (resolve, reject) {
        Counter('post', '/batch', {
          "requests": incrArr
        }).then((res) => {
          res = res.json();
          if (res.error) {
            throw res.error;
          }
          resolve(res);
        }).catch((error) => {
          console.error('Failed to save visitor count', error);
          reject(error);
        });
      });
    },

    // 构建自增请求体
    buildIncrement(objectId) {
      return {
        "method": "PUT",
        "path": `/1.1/classes/Counter/${ objectId }`,
        "body": {
          "times": {
            '__op': 'Increment',
            'amount': 1
          }
        }
      }
    },

    // 校验是否为有效的 UV
    validUV() {
      var key = 'LeanCloudUVTimestamp';
      var flag = localStorage.getItem(key);
      if (flag) {
        // 距离标记小于 24 小时则不计为 UV
        if (new Date().getTime() - parseInt(flag) <= 86400000) {
          return false;
        }
      }
      localStorage.setItem(key, new Date().getTime().toString());
      return true;
    },

    addCount(Counter) {
      var enableIncr = '' === 'true' && window.location.hostname !== 'localhost';
      enableIncr = true;
      var getterArr = [];
      var incrArr = [];
      // 请求 PV 并自增
      var pvCtn = document.querySelector('#lc-sv');
      if (pvCtn || enableIncr) {
        var pvGetter = this.getRecord(Counter, 'https://news.slqwq.cn' + '/#lc-sv', 'Visits').then((record) => {
          incrArr.push(this.buildIncrement(record.objectId))
          var eles = document.querySelectorAll('#lc-sv #number');
          if (eles.length > 0) {
            eles.forEach((el,index,array)=>{
              el.innerText = record.times + 1;
              if (pvCtn) {
                pvCtn.style.display = 'inline';
              }
            })
          }
        });
        getterArr.push(pvGetter);
      }

      // 请求 UV 并自增
      var uvCtn = document.querySelector('#lc-uv');
      if (uvCtn || enableIncr) {
        var uvGetter = this.getRecord(Counter, 'https://news.slqwq.cn' + '/#lc-uv', 'Visitors').then((record) => {
          var vuv = this.validUV();
          vuv && incrArr.push(this.buildIncrement(record.objectId))
          var eles = document.querySelectorAll('#lc-uv #number');
          if (eles.length > 0) {
            eles.forEach((el,index,array)=>{
              el.innerText = record.times + (vuv ? 1 : 0);
              if (uvCtn) {
                uvCtn.style.display = 'inline';
              }
            })
          }
        });
        getterArr.push(uvGetter);
      }

      // 请求文章的浏览数，如果是当前页面就自增
      var allPV = document.querySelectorAll('#lc-pv');
      if (allPV.length > 0 || enableIncr) {
        for (i = 0; i < allPV.length; i++) {
          let pv = allPV[i];
          let title = pv.getAttribute('data-title');
          var url = 'https://news.slqwq.cn' + pv.getAttribute('data-path');
          if (url) {
            var viewGetter = this.getRecord(Counter, url, title).then((record) => {
              // 是当前页面就自增
              let curPath = window.location.pathname;
              if (curPath.includes('index.html')) {
                curPath = curPath.substring(0, curPath.lastIndexOf('index.html'));
              }
              if (pv.getAttribute('data-path') == curPath) {
                incrArr.push(this.buildIncrement(record.objectId));
              }
              if (pv) {
                var ele = pv.querySelector('#lc-pv #number');
                if (ele) {
                  if (pv.getAttribute('data-path') == curPath) {
                    ele.innerText = (record.times || 0) + 1;
                  } else {
                    ele.innerText = record.times || 0;
                  }
                  pv.style.display = 'inline';
                }
              }
            });
            getterArr.push(viewGetter);
          }
        }
      }

      // 如果启动计数自增，批量发起自增请求
      if (enableIncr) {
        Promise.all(getterArr).then(() => {
          incrArr.length > 0 && this.increment(Counter, incrArr);
        })
      }

    },


    fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${ api_server }/1.1${ url }`, {
          method,
          headers: {
            'X-LC-Id': this.app_id,
            'X-LC-Key': this.app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      this.addCount(Counter);
    },

    refreshCounter() {
      var api_server = this.app_id.slice(-9) !== '-MdYXbMMI' ? this.custom_api_server : `https://${ this.app_id.slice(0, 8).toLowerCase() }.api.lncldglobal.com`;
      if (api_server) {
        this.fetchData(api_server);
      } else {
        fetch('https://app-router.leancloud.cn/2/route?appId=' + this.app_id)
          .then(resp => resp.json())
          .then(({api_server}) => {
            this.fetchData('https://' + api_server);
          });
      }
    }

  };

  LCCounter.refreshCounter();

  document.addEventListener('pjax:complete', function () {
    LCCounter.refreshCounter();
  });
</script><script>
const rootElement = document.documentElement;
const darkModeStorageKey = "user-color-scheme";
const rootElementDarkModeAttributeName = "data-user-color-scheme";

const setLS = (k, v) => {
    localStorage.setItem(k, v);
};

const removeLS = (k) => {
    localStorage.removeItem(k);
};

const getLS = (k) => {
    return localStorage.getItem(k);
};

const getModeFromCSSMediaQuery = () => {
  return window.matchMedia("(prefers-color-scheme: dark)").matches
    ? "dark"
    : "light";
};

const resetRootDarkModeAttributeAndLS = () => {
  rootElement.removeAttribute(rootElementDarkModeAttributeName);
  removeLS(darkModeStorageKey);
};

const validColorModeKeys = {
  dark: true,
  light: true,
};

const applyCustomDarkModeSettings = (mode) => {
  const currentSetting = mode || getLS(darkModeStorageKey);

  if (currentSetting === getModeFromCSSMediaQuery()) {
    resetRootDarkModeAttributeAndLS();
  } else if (validColorModeKeys[currentSetting]) {
    rootElement.setAttribute(rootElementDarkModeAttributeName, currentSetting);
  } else {
    resetRootDarkModeAttributeAndLS();
  }
};

const invertDarkModeObj = {
  dark: "light",
  light: "dark",
};

/**
 * get target mode
 */
const toggleCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);

  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  setLS(darkModeStorageKey, currentSetting);
  return currentSetting;
};

/**
 * bind click event for toggle button
 */
var btn=$("#wrapper .toggle-mode-btn,#rightmenu-wrapper .toggle-mode-btn");
function bindToggleButton() {
    btn.on('click',(e) => {
      const mode = toggleCustomDarkMode();
      applyCustomDarkModeSettings(mode);
    });
}

applyCustomDarkModeSettings();
document.addEventListener("DOMContentLoaded", bindToggleButton);
volantis.pjax.push(bindToggleButton);
volantis.pjax.send(()=>{
	btn.unbind('click');
},'toggle-mode-btn-unbind');
</script><script>
function listennSidebarTOC() {
  const navItems = document.querySelectorAll(".toc li");
  if (!navItems.length) return;
  const sections = [...navItems].map((element) => {
    const link = element.querySelector(".toc-link");
    const target = document.getElementById(
      decodeURI(link.getAttribute("href")).replace("#", "")
    );
    link.addEventListener("click", (event) => {
      event.preventDefault();
      window.scrollTo({
		top: target.offsetTop + 100,
		
		behavior: "smooth"
		
	  });
    });
    return target;
  });

  function activateNavByIndex(target) {
    if (target.classList.contains("active-current")) return;

    document.querySelectorAll(".toc .active").forEach((element) => {
      element.classList.remove("active", "active-current");
    });
    target.classList.add("active", "active-current");
    let parent = target.parentNode;
    while (!parent.matches(".toc")) {
      if (parent.matches("li")) parent.classList.add("active");
      parent = parent.parentNode;
    }
  }

  function findIndex(entries) {
    let index = 0;
    let entry = entries[index];
    if (entry.boundingClientRect.top > 0) {
      index = sections.indexOf(entry.target);
      return index === 0 ? 0 : index - 1;
    }
    for (; index < entries.length; index++) {
      if (entries[index].boundingClientRect.top <= 0) {
        entry = entries[index];
      } else {
        return sections.indexOf(entry.target);
      }
    }
    return sections.indexOf(entry.target);
  }

  function createIntersectionObserver(marginTop) {
    marginTop = Math.floor(marginTop + 10000);
    let intersectionObserver = new IntersectionObserver(
      (entries, observe) => {
        let scrollHeight = document.documentElement.scrollHeight + 100;
        if (scrollHeight > marginTop) {
          observe.disconnect();
          createIntersectionObserver(scrollHeight);
          return;
        }
        let index = findIndex(entries);
        activateNavByIndex(navItems[index]);
      },
      {
        rootMargin: marginTop + "px 0px -100% 0px",
        threshold: 0,
      }
    );
    sections.forEach((element) => {
      element && intersectionObserver.observe(element);
    });
  }
  createIntersectionObserver(document.documentElement.scrollHeight);
}

document.addEventListener("DOMContentLoaded", listennSidebarTOC);
document.addEventListener("pjax:success", listennSidebarTOC);
</script><script src=https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js></script><script>
    var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox])',
        selectors: [
          "title",
          
          "#pjax-container",
          "#pjax-header-nav-list"
        ],
        cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
        timeout: 5000
      });
    });

    document.addEventListener('pjax:send', function (e) {
      //window.stop(); // 相当于点击了浏览器的停止按钮

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      window.subData = null; // 移除标题（用于一二级导航栏切换处）

      volantis.$switcher.removeClass('active'); // 关闭移动端激活的搜索框
      volantis.$header.removeClass('z_search-open'); // 关闭移动端激活的搜索框
      volantis.$wrapper.removeClass('sub'); // 跳转页面时关闭二级导航

      // 解绑事件 避免重复监听
      volantis.$topBtn.unbind('click');
      $('.menu a').unbind('click');
      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');
	  // 使用 volantis.pjax.send 方法传入pjax:send回调函数 参见layout/_partial/scripts/global.ejs
	  volantis.pjax.method.send.start();
    });

    document.addEventListener('pjax:complete', function () {
      $('.nav-main').find('.list-v').not('.menu-phone').removeAttr("style",""); // 移除小尾巴的移除
      $('.menu-phone.list-v').removeAttr("style",""); // 移除小尾巴的移除
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
      try{
		// 使用 volantis.pjax.push 方法传入重载函数 参见layout/_partial/scripts/global.ejs
		volantis.pjax.method.complete.start();
      } catch (e) {
        console.log(e);
      }
    });

    document.addEventListener('pjax:error', function (e) {
	  // 使用 volantis.pjax.error 方法传入pjax:error回调函数 参见layout/_partial/scripts/global.ejs
	  volantis.pjax.method.error.start();
      window.location.href = e.triggerElement.href;
    });
</script></div></body></html>